<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
	<head>
		<title>FCKeditor - Resources Browser</title>
		<link href="browser.css" type="text/css" rel="stylesheet">
		<script type="text/javascript" src="js/fckxml.js"></script>
		<script language="javascript">


var oConnector = new Object() ;
// oConnector.CurrentFolder	= '/pnbhelp/helpimg/';
oConnector.CurrentFolder	= GetUrlParam('folder');
//alert(window.location.href);
var sConnUrl = window.location.href.replace( /.*browser.html/, GetUrlParam('Connector'));
//alert(sConnUrl);

oConnector.ConnectorUrl = sConnUrl + ( sConnUrl.indexOf('?') != -1 ? '&' : '?' ) ;

var sServerPath = GetUrlParam( 'ServerPath' );
if ( sServerPath.length > 0 ) {
	oConnector.ConnectorUrl += 'ServerPath=' + encodeURIComponent( sServerPath ) + '&' ;
}	
	
oConnector.ResourceType	= GetUrlParam( 'Type' );

//alert(oConnector.ResourceType);

oConnector.ShowAllTypes		= ( oConnector.ResourceType.length == 0 ) ;

if ( oConnector.ShowAllTypes )
	oConnector.ResourceType = 'Link';

oConnector.SendCommand = function( command, params, callBackFunction ) {
	var sUrl = this.ConnectorUrl + 'Command=' + command ;
	sUrl += '&Type=' + this.ResourceType ;
	sUrl += '&CurrentFolder=' + encodeURIComponent( this.CurrentFolder ) ;
	
	if ( params ) sUrl += '&' + params ;

	var oXML = new FCKXml();
	
	if ( callBackFunction ) {
		oXML.LoadUrl( sUrl, callBackFunction ) ;	// Asynchronous load.
	} else {
		return oXML.LoadUrl( sUrl );
	}
}

oConnector.CheckError = function( responseXml ) {
	var iErrorNumber = 0 ;
	var oErrorNode = responseXml.SelectSingleNode( 'Connector/Error' ) ;
	
	if ( oErrorNode )
	{
		iErrorNumber = parseInt( oErrorNode.attributes.getNamedItem('number').value, 10 ) ;
		
		switch ( iErrorNumber )
		{
			case 0 :
				break ;
			case 1 :	// Custom error. Message placed in the "text" attribute.
				alert( oErrorNode.attributes.getNamedItem('text').value ) ;
				break ;
			case 101 :
				alert( 'Folder already exists' ) ;
				break ;
			case 102 :
				alert( 'Invalid folder name' ) ;
				break ;
			case 103 :
				alert( 'You have no permissions to create the folder' ) ;
				break ;
			case 110 :
				alert( 'Unknown error creating folder' ) ;
				break ;
			default :
				alert( 'Error on your request. Error number: ' + iErrorNumber ) ;
				break ;
		}
	}
	return iErrorNumber ;
}

var oIcons = new Object() ;

oIcons.AvailableIconsArray = [ 
	'ai','avi','bmp','cs','dll','doc','exe','fla','gif','htm','html','jpg','js',
	'mdb','mp3','pdf','ppt','rdp','swf','swt','txt','vsd','xls','xml','zip' ] ;
	
oIcons.AvailableIcons = new Object() ;

for ( var i = 0 ; i < oIcons.AvailableIconsArray.length ; i++ )
	oIcons.AvailableIcons[ oIcons.AvailableIconsArray[i] ] = true ;

oIcons.GetIcon = function( fileName ) {
	var sExtension = fileName.substr( fileName.lastIndexOf('.') + 1 ).toLowerCase() ;

	if ( this.AvailableIcons[ sExtension ] == true )
		return sExtension ;
	else
		return 'default.icon' ;
}

function GetUrlParam( paramName ) {
	var qs = window.top.location.search;
	qs = qs.replace( /&amp;/g, '&' );
	var oRegex = new RegExp( '[\?&]' + paramName + '=([^&]+)', 'i' ) ;
	var oMatch = oRegex.exec( qs ) ;
	
	if ( oMatch && oMatch.length > 1 )
		return decodeURIComponent( oMatch[1] ) ;
	else
		return '' ;
}

	</script>
	</head>
	<frameset rows="50,*" class="Frame" framespacing="3" bordercolor="#f1f1e3" frameborder="0">
		<frameset cols="150,150,*,0" framespacing="0">
			<frame src="frmresourcetype.html" scrolling="no" frameborder="0">
			<frame name="frmCreateFolder" src="frmcreatefolder.html" scrolling="no" frameborder="0">
			<frame name="frmUpload" src="frmupload.html" scrolling="auto" frameborder="0">
			<frame name="frmUploadWorker" src="javascript:void(0)" scrolling="auto" frameborder="0">
		</frameset>
		<frameset cols="420,*,0" class="Frame" framespacing="3" bordercolor="#f1f1e3" frameborder="0">
			<frameset rows="*,350" class="Frame" framespacing="3" bordercolor="#f1f1e3" frameborder="0">	
				<frame name="frmFolders" src="frmfolders.html" scrolling="auto" frameborder="0">
				<frame name="testFrame" src="frmpreview.html" scrolling="auto" frameborder="1">
			</frameset>
			<frame name="frmResourcesList" src="frmresourceslist.html" scrolling="auto" frameborder="1">
			<frame name="frmActualFolder" src="frmactualfolder.html" scrolling="no" frameborder="0">
		</frameset>
	</frameset>
</html>
